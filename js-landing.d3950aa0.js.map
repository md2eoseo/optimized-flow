{"version":3,"sources":["js-landing.js"],"names":["DB_URL","API_KEY","window","addEventListener","form","document","querySelector","setAttribute","querySelectorAll","forEach","ele","checkValidationBeforeSubmit","submitInfo","isClientSubmitted","e","target","value","classList","remove","checkValidity","add","parentNode","preventDefault","checkValidation","elements","full_name","work_email","job_title","country","company","agree","full_name_p","work_email_p","job_title_p","agree_p","trim","checkData","console","log","focus","error","data","fetch","method","headers","then","res","json","exist","length","cnt","post","$inc","put","_id","id","putData","JSON","stringify","body","localStorage","setItem","location","catch","postData","client","parse","getItem","textContent"],"mappings":"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","file":"js-landing.d3950aa0.js","sourceRoot":"..","sourcesContent":["\"use strict\";\r\nconst DB_URL = \"https://todoweb-a2c8.restdb.io/rest/client\";\r\nconst API_KEY = \"5e9e0988436377171a0c266d\";\r\n\r\nwindow.addEventListener(\"load\", () => {\r\n  const form = document.querySelector(\".form form\");\r\n  form.setAttribute(\"novalidate\", true);\r\n  form\r\n    .querySelectorAll(\"[required]\")\r\n    .forEach((ele) =>\r\n      ele.addEventListener(\"input\", checkValidationBeforeSubmit)\r\n    );\r\n  form.addEventListener(\"submit\", submitInfo);\r\n  isClientSubmitted();\r\n});\r\n\r\nfunction checkValidationBeforeSubmit(e) {\r\n  e.target.value = e.target.value;\r\n  e.target.classList.remove(\"invalid\");\r\n  if (!e.target.checkValidity()) {\r\n    e.target.classList.add(\"invalid\");\r\n    e.target.parentNode.querySelector(\"p\").classList.remove(\"hidden\");\r\n  } else {\r\n    e.target.parentNode.querySelector(\"p\").classList.add(\"hidden\");\r\n  }\r\n}\r\n\r\nfunction submitInfo(e) {\r\n  e.preventDefault();\r\n  checkValidation(e.target);\r\n}\r\n\r\nfunction checkValidation(form) {\r\n  const elements = form.elements;\r\n  const full_name = elements.full_name;\r\n  const work_email = elements.work_email;\r\n  const job_title = elements.job_title;\r\n  const country = elements.country;\r\n  const company = elements.company;\r\n  const agree = elements.agree;\r\n  const full_name_p = form.querySelector(\"#full_name_p\");\r\n  const work_email_p = form.querySelector(\"#work_email_p\");\r\n  const job_title_p = form.querySelector(\"#job_title_p\");\r\n  const agree_p = form.querySelector(\"#agree_p\");\r\n  full_name.value = full_name.value.trim();\r\n  work_email.value = work_email.value.trim();\r\n  job_title.value = job_title.value.trim();\r\n  company.value = company.value.trim();\r\n\r\n  // initialize previous invalid inputs\r\n  document.querySelectorAll(\"input, select\").forEach((ele) => {\r\n    ele.classList.remove(\"invalid\");\r\n  });\r\n\r\n  if (form.checkValidity()) {\r\n    checkData({\r\n      full_name: full_name.value,\r\n      work_email: work_email.value,\r\n      job_title: job_title.value,\r\n      country: country.value,\r\n      company: company.value,\r\n    });\r\n    console.log(\"submitted \" + work_email.value.trim());\r\n    return true;\r\n  } else {\r\n    // check every inputs' validity\r\n    if (!job_title.checkValidity()) {\r\n      job_title.classList.add(\"invalid\");\r\n      job_title_p.classList.remove(\"hidden\");\r\n      job_title.focus();\r\n    } else {\r\n      job_title_p.classList.add(\"hidden\");\r\n    }\r\n    if (!work_email.checkValidity()) {\r\n      work_email.classList.add(\"invalid\");\r\n      work_email_p.classList.remove(\"hidden\");\r\n      work_email.focus();\r\n    } else {\r\n      work_email_p.classList.add(\"hidden\");\r\n    }\r\n    if (!full_name.checkValidity()) {\r\n      full_name.classList.add(\"invalid\");\r\n      full_name_p.classList.remove(\"hidden\");\r\n      full_name.focus();\r\n    } else {\r\n      full_name_p.classList.add(\"hidden\");\r\n    }\r\n    if (!agree.checkValidity()) {\r\n      agree.classList.add(\"invalid\");\r\n      agree_p.classList.remove(\"hidden\");\r\n      agree.focus();\r\n    } else {\r\n      agree_p.classList.add(\"hidden\");\r\n    }\r\n\r\n    console.error(\"Validation False!\");\r\n  }\r\n}\r\n\r\nfunction checkData(data) {\r\n  fetch(`${DB_URL}?q={\"work_email\": \"${data.work_email}\"}`, {\r\n    method: \"get\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json; charset=utf-8\",\r\n      \"x-apikey\": API_KEY,\r\n      \"cache-control\": \"no-cache\",\r\n    },\r\n  })\r\n    .then((res) => res.json())\r\n    .then((exist) => {\r\n      if (!exist.length) {\r\n        data.cnt = 1;\r\n        post(data);\r\n      } else {\r\n        data.$inc = { cnt: 1 };\r\n        put(data, exist[0]._id);\r\n      }\r\n    });\r\n}\r\n\r\nfunction put(data, id) {\r\n  const putData = JSON.stringify(data);\r\n  fetch(`${DB_URL}/${id}`, {\r\n    method: \"put\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json; charset=utf-8\",\r\n      \"x-apikey\": API_KEY,\r\n      \"cache-control\": \"no-cache\",\r\n    },\r\n    body: putData,\r\n  })\r\n    .then((res) => res.json())\r\n    .then(() => {\r\n      console.log(`already ${data.work_email} existsd!`);\r\n      localStorage.setItem(\"isClientSubmitted\", [JSON.stringify(data)]);\r\n    })\r\n    .then(() => (window.location = \"asset.html\"))\r\n    .catch((error) => {\r\n      console.error(`PUT ERROR: ${error}`);\r\n    });\r\n}\r\n\r\nfunction post(data) {\r\n  const postData = JSON.stringify(data);\r\n  fetch(DB_URL, {\r\n    method: \"post\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json; charset=utf-8\",\r\n      \"x-apikey\": API_KEY,\r\n      \"cache-control\": \"no-cache\",\r\n    },\r\n    body: postData,\r\n  })\r\n    .then((res) => res.json())\r\n    .then(() => {\r\n      console.log(`inserted ${postData} into client list!`);\r\n      localStorage.setItem(\"isClientSubmitted\", [JSON.stringify(data)]);\r\n    })\r\n    .then(() => (window.location = \"asset.html\"))\r\n    .catch((error) => {\r\n      console.error(`POST ERROR: ${error}`);\r\n    });\r\n}\r\n\r\nfunction isClientSubmitted() {\r\n  const client = JSON.parse(localStorage.getItem(\"isClientSubmitted\"));\r\n\r\n  if (client != null) {\r\n    document.querySelector(\r\n      \"#tagline3\"\r\n    ).textContent = `Welcome back, ${client.full_name}!`;\r\n    document.querySelector(\"#subs-btn\").textContent = \"To the Asset\";\r\n    document\r\n      .querySelector(\"#subs-btn\")\r\n      .addEventListener(\"click\", () => (window.location = \"asset.html\"));\r\n  } else {\r\n    document.querySelector(\"#subs-btn\").addEventListener(\"click\", () => {\r\n      window.location = \"#form\";\r\n      document.querySelector(\".form form\").elements.full_name.focus();\r\n    });\r\n  }\r\n}\r\n"]}